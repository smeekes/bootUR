<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bootUR">
<title>Introduction to bootUR • bootUR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to bootUR">
<meta property="og:description" content="bootUR">
<meta property="og:image" content="https://smeekes.github.io/bootUR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bootUR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3.999</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/bootUR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/smeekes/bootUR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to bootUR</h1>
                        <h4 data-toc-skip class="author">Stephan Smeekes
and Ines Wilms</h4>
            
            <h4 data-toc-skip class="date">17 May, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/smeekes/bootUR/blob/HEAD/vignettes/bootUR.Rmd" class="external-link"><code>vignettes/bootUR.Rmd</code></a></small>
      <div class="d-none name"><code>bootUR.Rmd</code></div>
    </div>

    
    
<p>The R package <code>bootUR</code> implements several bootstrap tests
for unit roots, both for single time series and for (potentially) large
systems of time series.</p>
<div class="section level2">
<h2 id="installation-and-loading">Installation and Loading<a class="anchor" aria-label="anchor" href="#installation-and-loading"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>The package can be installed from CRAN using</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"bootUR"</span><span class="op">)</span></span></code></pre></div>
<p>The development version of the <code>bootUR</code> package can be
installed from GitHub using</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"smeekes/bootUR"</span><span class="op">)</span></span></code></pre></div>
<p>When installing from GitHub, in order to build the package from
source, you need to have the appropriate R development tools installed
(<a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a> on
Windows, or <a href="https://mac.r-project.org/tools/" class="external-link">these tools</a>
on Mac).</p>
<p>If you want the vignette to appear in your package when installing
from GitHub, use</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"smeekes/bootUR"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>instead. As building the vignette may take a bit of time (all
bootstrap code below is run), package installation will be slower this
way.</p>
</div>
<div class="section level3">
<h3 id="load-package">Load Package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h3>
<p>After installation, the package can be loaded in the standard
way:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/smeekes/bootUR" class="external-link">bootUR</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="preliminary-analysis-missing-values">Preliminary Analysis: Missing Values<a class="anchor" aria-label="anchor" href="#preliminary-analysis-missing-values"></a>
</h2>
<p><code>bootUR</code> provides a few simple tools to check if your data
are suitable to be bootstrapped.</p>
<div class="section level3">
<h3 id="inspect-data-for-missing-values">Inspect Data for Missing Values<a class="anchor" aria-label="anchor" href="#inspect-data-for-missing-values"></a>
</h3>
<p>The bootstrap tests in <code>bootUR</code> do not work with missing
data, although multivariate time series with different start and end
dates (unbalanced panels) are allowed. <code>bootUR</code> provides a
simple function to check if your data contain missing values. We will
illustrate this on the <code>MacroTS</code> dataset of macroeconomic
time series that comes with the package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"MacroTS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/check_missing_insample_values.html">check_missing_insample_values</a></span><span class="op">(</span><span class="va">MacroTS</span><span class="op">)</span></span>
<span><span class="co">#&gt;  GDP_BE  GDP_DE  GDP_FR  GDP_NL  GDP_UK CONS_BE CONS_DE CONS_FR CONS_NL CONS_UK </span></span>
<span><span class="co">#&gt;   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE </span></span>
<span><span class="co">#&gt; HICP_BE HICP_DE HICP_FR HICP_NL HICP_UK   UR_BE   UR_DE   UR_FR   UR_NL   UR_UK </span></span>
<span><span class="co">#&gt;   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checking-start-and-end-points-of-time-series">Checking Start and End Points of Time Series<a class="anchor" aria-label="anchor" href="#checking-start-and-end-points-of-time-series"></a>
</h3>
<p>If your time series have different starting and end points (and thus
some series contain <code>NA</code>s at the beginning and/or end of your
sample, the resampling-based moving block bootstrap (MBB) and sieve
bootstrap (SB) cannot be used. <code>bootUR</code> lets you check the
start and end points as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_nonmissing_subsample.html">find_nonmissing_subsample</a></span><span class="op">(</span><span class="va">MacroTS</span><span class="op">)</span></span>
<span><span class="co"># Provides the number of the first and last non-missing observation for each series:</span></span>
<span><span class="va">sample_check</span><span class="op">$</span><span class="va">range</span> </span>
<span><span class="co">#&gt;       GDP_BE GDP_DE GDP_FR GDP_NL GDP_UK CONS_BE CONS_DE CONS_FR CONS_NL</span></span>
<span><span class="co">#&gt; first      1      1      1      5      1       1       1       1       5</span></span>
<span><span class="co">#&gt; last     100    100    100    100    100     100     100     100     100</span></span>
<span><span class="co">#&gt;       CONS_UK HICP_BE HICP_DE HICP_FR HICP_NL HICP_UK UR_BE UR_DE UR_FR UR_NL</span></span>
<span><span class="co">#&gt; first       1       9       9       9       9       9     1     1     1     1</span></span>
<span><span class="co">#&gt; last      100     100     100     100     100     100   100   100   100   100</span></span>
<span><span class="co">#&gt;       UR_UK</span></span>
<span><span class="co">#&gt; first     1</span></span>
<span><span class="co">#&gt; last    100</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gives TRUE if the time series all start and end at the same observation:</span></span>
<span><span class="va">sample_check</span><span class="op">$</span><span class="va">all_equal</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-missing-data">Visualizing Missing Data<a class="anchor" aria-label="anchor" href="#visualizing-missing-data"></a>
</h3>
<p>If you have <code>ggplot2</code> installed, you can also plot the
missing data patterns in your series to get a quick overview. You may
need to manipulate some arguments to get the plot properly sized
(therefore it is not run here automatically).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_missing_values.html">plot_missing_values</a></span><span class="op">(</span><span class="va">MacroTS</span>, show_names <span class="op">=</span> <span class="cn">TRUE</span>, axis_text_size <span class="op">=</span> <span class="fl">5</span>, legend_size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="augmented-dickey-fuller-test">Augmented Dickey-Fuller Test<a class="anchor" aria-label="anchor" href="#augmented-dickey-fuller-test"></a>
</h2>
<p>As the standard test for unit roots, <code>bootUR</code> also has an
implementation of the standard, non-bootstrap, augmented Dickey-Fuller
(ADF) test (though its use is not recommended if sample sizes are
small). For this purpose the <code><a href="../reference/adf.html">adf()</a></code> function can be used.
The function allows to set many options. First, one can choose between
the classical single-step procedure (<code>two_step = FALSE</code>), in
which deterministic components are directly included in the test
regression, and the more flexible and modern two-step procedure
(<code>two_step = TRUE</code>) where deterministic components are first
removed before applying the unit root test to detrended data. For the
standard ADF test, the two specifications generally yield nearly
identical results.</p>
<p><strong>Lag selection</strong></p>
<p>Lag length selection is done automatically in the ADF regression; the
default is by the modified Akaike information criterion (MAIC) proposed
by Ng and Perron (2001) with the correction of Perron and Qu (2008).
Other options include the regular Akaike information criterion (AIC), as
well as the Bayesian information criterion and its modified variant. In
addition, the rescaling suggested by Cavaliere et al. (2015) is
implemented to improve the power of the test under heteroskedasticity;
this can be turned off by setting <code>criterion_scale = FALSE</code>.
To overwrite data-driven lag length selection with a pre-specified lag
length, simply set both the minimum <code>min_lag</code> and maximum lag
length <code>max_lag</code> for the selection algorithm equal to the
desired lag length.</p>
<p><strong>Implementation</strong></p>
<p>We illustrate the ADF test here on Dutch GDP for the two-step
specification, including a linear trend in the specification.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GDP_NL</span> <span class="op">&lt;-</span> <span class="va">MacroTS</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/adf.html">adf</a></span><span class="op">(</span><span class="va">GDP_NL</span>, deterministics <span class="op">=</span> <span class="st">"trend"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two-step ADF test (with trend) on a single time series</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: GDP_NL</span></span>
<span><span class="co">#&gt; null hypothesis: Series has a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Series is stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        estimate largest root statistic p-value</span></span>
<span><span class="co">#&gt; GDP_NL                0.9471    -2.515  0.3202</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="univariate-bootstrap-unit-root-tests">Univariate Bootstrap Unit Root Tests<a class="anchor" aria-label="anchor" href="#univariate-bootstrap-unit-root-tests"></a>
</h2>
<div class="section level3">
<h3 id="augmented-dickey-fuller-test-1">Augmented Dickey-Fuller Test<a class="anchor" aria-label="anchor" href="#augmented-dickey-fuller-test-1"></a>
</h3>
<p>To perform a bootstrap version of the ADF unit root test on a single
time series, use the <code><a href="../reference/boot_adf.html">boot_adf()</a></code> function. The function
allows to set many options, including the bootstrap method used (option
<code>bootstrap</code>), the deterministic components included (option
<code>deterministics</code>) and the type of detrending used (option
<code>detrend</code>). While <code>detrend = "OLS"</code> gives the
standard ADF test, <code>detrend = "QD"</code> provides the powerful
DF-GLS test of Elliott, Rothenberg and Stock (1996). Here we use the
terminology Quasi-Differencing (QD) rather than GLS as this conveys the
meaning less ambiguously and is the same terminology used by Smeekes and
Taylor (2012) and Smeekes (2013). In all cases, two-step detrending is
used.</p>
<p><strong>Implementation</strong></p>
<p>We illustrate the bootstrap ADF test here on Dutch GDP, with the
sieve bootstrap (<code>bootstrap = SB</code>) as in the specification
used by Palm, Smeekes and Urbain (2008) and Smeekes (2013). To get the
well-known test proposed by Paparoditis and Politis (2003), set
<code>bootstrap = "MBB"</code>. We set only 399 bootstrap replications
(<code>B = 399</code>) to prevent the code from running too long. We add
an intercept and a trend (<code>deterministics = "trend"</code>) and OLS
detrending. The console gives you live updates on the bootstrap
progress. To turn these off, set <code>show_progress = FALSE</code>. The
bootstrap loop can be run in parallel by setting
<code>do_parallel = TRUE</code> (the default).</p>
<p>As random number generation is required to draw bootstrap samples, we
first set the seed of the random number generator to obtain replicable
results.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">155776</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/boot_adf.html">boot_adf</a></span><span class="op">(</span><span class="va">GDP_NL</span>, B <span class="op">=</span> <span class="fl">399</span>, bootstrap <span class="op">=</span> <span class="st">"SB"</span>, deterministics <span class="op">=</span> <span class="st">"trend"</span>, </span>
<span>                    detrend <span class="op">=</span> <span class="st">"OLS"</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  SB bootstrap OLS test (with intercept and trend) on a single time</span></span>
<span><span class="co">#&gt;  series</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: GDP_NL</span></span>
<span><span class="co">#&gt; null hypothesis: Series has a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Series is stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        estimate largest root statistic p-value</span></span>
<span><span class="co">#&gt; GDP_NL                0.9471    -2.515  0.1454</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="union-of-rejections-test">Union of Rejections Test<a class="anchor" aria-label="anchor" href="#union-of-rejections-test"></a>
</h3>
<p>Use <code><a href="../reference/boot_union.html">boot_union()</a></code> for a test based on the union of
rejections of 4 tests with different number of deterministic components
and different type of detrending (Smeekes and Taylor, 2012). The
advantage of the union test is that you don’t have to specify these
(rather influential) specification tests. This makes the union test a
safe option for quick or automatic unit root testing where careful
manual specification setup is not viable. Here we illustrate it with the
sieve wild bootstrap as proposed by Smeekes and Taylor (2012).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot_union.html">boot_union</a></span><span class="op">(</span><span class="va">GDP_NL</span>, B <span class="op">=</span> <span class="fl">399</span>, bootstrap <span class="op">=</span> <span class="st">"SWB"</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  SWB bootstrap union test on a single time series</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: GDP_NL</span></span>
<span><span class="co">#&gt; null hypothesis: Series has a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Series is stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        estimate largest root statistic p-value</span></span>
<span><span class="co">#&gt; GDP_NL                    NA   -0.7115   0.614</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="panel-unit-root-test">Panel Unit Root Test<a class="anchor" aria-label="anchor" href="#panel-unit-root-test"></a>
</h2>
<p>The function <code>boot_panel</code> performs a test on a
multivariate (panel) time series by testing the null hypothesis that all
series have a unit root. A rejection is typically interpreted as
evidence that a ‘significant proportion’ of the series is stationary,
although how large that proportion is - or which series are stationary -
is not given by the test. The test is based on averaging the individual
test statistics, also called the Group-Mean (GM) test in Palm, Smeekes
and Urbain (2011).</p>
<p>Palm, Smeekes and Urbain (2011) introduced this test with the moving
block bootstrap (<code>bootstrap = "MBB"</code>). However, this
resampling-based method cannot handle unbalancedness, and will therefore
give an error when applied to <code>MacroTS</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot_panel.html">boot_panel</a></span><span class="op">(</span><span class="va">MacroTS</span>, bootstrap <span class="op">=</span> <span class="st">"MBB"</span>, B <span class="op">=</span> <span class="fl">399</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in check_inputs(data = data, boot_sqt_test = boot_sqt_test, boot_ur_test = boot_ur_test, : Resampling-based bootstraps MBB and SB cannot handle unbalanced series.</span></span></code></pre></div>
<p>Therefore, you should switch to one of the wild bootstrap methods.
Here we illustrate it with the dependent wild bootstrap (DWB) of Shao
(2010) and Rho and Shao (2019).</p>
<p>By default the union test is used for each series
(<code>union = TRUE</code>), if this is set to <code>FALSE</code> the
deterministic components and detrending methods can be specified as in
the univariate Dickey-Fuller test.</p>
<p>Although the sieve bootstrap method <code>"SB"</code> and
<code>"SWB"</code> can be used (historically they have been popular
among practitioners), Smeekes and Urbain (2014b) show that these are not
suited to capture general forms of dependence across units. The code
will give a warning to recommend using a different bootstrap method.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot_panel.html">boot_panel</a></span><span class="op">(</span><span class="va">MacroTS</span>, bootstrap <span class="op">=</span> <span class="st">"DWB"</span>, B <span class="op">=</span> <span class="fl">399</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Panel DWB bootstrap group-mean union test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: MacroTS</span></span>
<span><span class="co">#&gt; null hypothesis: All series have a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Some series are stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         estimate largest root statistic p-value</span></span>
<span><span class="co">#&gt; MacroTS                    NA   -0.8621  0.1103</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tests-for-multiple-time-series">Tests for Multiple Time Series<a class="anchor" aria-label="anchor" href="#tests-for-multiple-time-series"></a>
</h2>
<div class="section level3">
<h3 id="individual-adf-tests">Individual ADF Tests<a class="anchor" aria-label="anchor" href="#individual-adf-tests"></a>
</h3>
<p>To perform individual ADF tests on multiple time series
simultaneously, the function <code><a href="../reference/boot_ur.html">boot_ur()</a></code> can still be used.
As the bootstrap is performed for all series simultaneously,
resampling-based bootstrap methods <code>"MBB"</code> and
<code>"SB"</code> cannot be used directly in case of unbalanced panels.
If they are used anyway, the function will revert to splitting the
bootstrap up and performing it individually per time series. In this
case a warning is given to alert the user.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADFtests_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boot_ur.html">boot_ur</a></span><span class="op">(</span><span class="va">MacroTS</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, bootstrap <span class="op">=</span> <span class="st">"MBB"</span>, B <span class="op">=</span> <span class="fl">399</span>, union <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                        deterministics <span class="op">=</span> <span class="st">"trend"</span>, detrend <span class="op">=</span> <span class="st">"OLS"</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in check_inputs(data = data, boot_sqt_test = boot_sqt_test,</span></span>
<span><span class="co">#&gt; boot_ur_test = boot_ur_test, : Missing values cause resampling bootstrap to be</span></span>
<span><span class="co">#&gt; executed for each time series individually.</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ADFtests_out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  MBB bootstrap ADF test (with intercept and trend) on each individual</span></span>
<span><span class="co">#&gt;  series (no multiple testing correction)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: MacroTS[, 1:5]</span></span>
<span><span class="co">#&gt; null hypothesis: Series has a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Series is stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tests performed on each series: </span></span>
<span><span class="co">#&gt;        estimate largest root statistic p-value</span></span>
<span><span class="co">#&gt; GDP_BE                0.9304    -2.792  0.1955</span></span>
<span><span class="co">#&gt; GDP_DE                0.8911    -2.774  0.1003</span></span>
<span><span class="co">#&gt; GDP_FR                0.9655    -2.049  0.5113</span></span>
<span><span class="co">#&gt; GDP_NL                0.9471    -2.515  0.1930</span></span>
<span><span class="co">#&gt; GDP_UK                0.9600    -2.449  0.2882</span></span></code></pre></div>
<p>Note that <code>boot_ur</code> (intentionally) does not provide a
correction for multiple testing; of course, if we perform each test with
a significance level of 5%, the probability of making a mistake in all
these tests becomes (much, if <code>N</code> is large) more than 5%. To
explicitly account for multiple testing, use the functions
<code><a href="../reference/boot_sqt.html">boot_sqt()</a></code> or <code><a href="../reference/boot_fdr.html">boot_fdr()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="bootstrap-sequential-tests">Bootstrap Sequential Tests<a class="anchor" aria-label="anchor" href="#bootstrap-sequential-tests"></a>
</h3>
<p>The function <code><a href="../reference/boot_sqt.html">boot_sqt()</a></code> performs the Bootstrap
Sequential Quantile Test (BSQT) proposed by Smeekes (2015). Here we
split the series in groups which are consecutively tested for unit
roots, starting with the group most likely to be stationary (having the
smallest ADF statistics). If the unit root hypothesis cannot be rejected
for the first group, the algorithm stops; if there is a rejection, the
second group is tested, and so on.</p>
<p>Most options are the same as for <code>boot_panel</code>. The
parameter <code>SQT_level</code> controls the significance level of the
individual tests performed in the sequence, with a default value of
0.05. The other important new parameter to set here is the group sizes.
These can either be set in units, or in fractions of the total number of
series (i.e. quantiles, hence the name) via the parameter
<code>steps</code>. If we have <code>N</code> time series, setting
<code>steps = 0:N</code> means each unit should be tested sequentially.
To split the series in four equally sized groups (regardless of many
series there are), use <code>steps = 0:4 / 4</code>. By convention and
in accordance with notation in Smeekes (2015), the first entry of the
vector should be equal to zero, while the second entry indicates the end
of the first group, and so on. However, if the initial zero is
accidentally omitted, it is automatically added by the function.
Similarly, if the final value is not equal to <code>1</code> (in case of
quantiles) or <code>N</code> to end the last group, this is added by the
function.</p>
<p>Testing individual series consecutively is easiest for
interpretation, but is only meaningful if <code>N</code> is small. In
this case the method is equivalent to the bootstrap StepM method of
Romano and Wolf (2005), which controls the familywise error rate, that
is the probability of making at least one false rejection. This can get
very conservative if <code>N</code> is large, and you would typically
end up not rejecting any null hypothesis. The method is illustrated with
the autoregressive wild bootstrap of Smeekes and Urbain (2014a) and
Friedrich, Smeekes and Urbain (2020).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">MacroTS</span><span class="op">)</span></span>
<span><span class="co"># Test each unit sequentially</span></span>
<span><span class="fu"><a href="../reference/boot_sqt.html">boot_sqt</a></span><span class="op">(</span><span class="va">MacroTS</span>, steps <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">N</span>, bootstrap <span class="op">=</span> <span class="st">"AWB"</span>, B <span class="op">=</span> <span class="fl">399</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  AWB bootstrap sequential quantile union test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: MacroTS</span></span>
<span><span class="co">#&gt; null hypothesis: Series has a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Series is stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sequence of tests: </span></span>
<span><span class="co">#&gt;        H0: # I(0) H1: # I(0)  tstat p-value</span></span>
<span><span class="co">#&gt; Step 1          0          1 -1.661 0.02256</span></span>
<span><span class="co">#&gt; Step 2          1          2 -1.413 0.12281</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Split in four equally sized groups (motivated by the 4 series per country)</span></span>
<span><span class="fu"><a href="../reference/boot_sqt.html">boot_sqt</a></span><span class="op">(</span><span class="va">MacroTS</span>, steps <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span> <span class="op">/</span> <span class="fl">4</span>, bootstrap <span class="op">=</span> <span class="st">"AWB"</span>, B <span class="op">=</span> <span class="fl">399</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  AWB bootstrap sequential quantile union test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: MacroTS</span></span>
<span><span class="co">#&gt; null hypothesis: Series has a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Series is stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sequence of tests: </span></span>
<span><span class="co">#&gt;        H0: # I(0) H1: # I(0)  tstat p-value</span></span>
<span><span class="co">#&gt; Step 1          0          5 -1.052 0.05013</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bootstrap-fdr-controlling-tests">Bootstrap FDR Controlling Tests<a class="anchor" aria-label="anchor" href="#bootstrap-fdr-controlling-tests"></a>
</h3>
<p>The function <code><a href="../reference/boot_fdr.html">boot_fdr()</a></code> controls for multiple testing by
controlling the false discovery rate (FDR), which is defined as the
expected proportion of false rejections relative to the total number of
rejections. This scales with the total number of tests, making it more
suitable for large <code>N</code> than the familywise error rate.</p>
<p>The bootstrap method for controlling FDR was introduced by Romano,
Shaikh and Wolf (2008), who showed that, unlike the classical way to
control FDR, the bootstrap is appropriate under general forms of
dependence between series. Moon and Perron (2012) applied this method to
unit root testing; it is essentially their method which is implemented
in <code><a href="../reference/boot_fdr.html">boot_fdr()</a></code> though again with the option to change the
bootstrap used (their suggestion was MBB). The arguments to be set are
the same as for the other multivariate unit root tests, with the
exception of <code>FDR_level</code> wihch controls the FDR level. As
BSQT, the method only report those tests until no rejection occurs.</p>
<p>We illustrate it here with the final available bootstrap method, the
block wild bootstrap of Shao (2011) and Smeekes and Urbain (2014a).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot_fdr.html">boot_fdr</a></span><span class="op">(</span><span class="va">MacroTS</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, FDR_level <span class="op">=</span> <span class="fl">0.1</span>, bootstrap <span class="op">=</span> <span class="st">"BWB"</span>, B <span class="op">=</span> <span class="fl">399</span>, do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  BWB bootstrap union test with false discovery rate control</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: MacroTS[, 1:10]</span></span>
<span><span class="co">#&gt; null hypothesis: Series has a unit root</span></span>
<span><span class="co">#&gt; alternative hypothesis: Series is stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sequence of tests: </span></span>
<span><span class="co">#&gt;         tstat critical value</span></span>
<span><span class="co">#&gt; GDP_DE -1.077         -1.581</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="determining-order-of-integration">Determining Order of Integration<a class="anchor" aria-label="anchor" href="#determining-order-of-integration"></a>
</h2>
<p>Generally the unit root tests above would only be used as a single
step in a larger algorithm to determine the orders of integration of the
time series in the dataset. In particular, many economic datasets
contain variables that have order of integration 2, and would so need to
be differenced twice to eliminate all trends. A standard unit root test
cannot determine this however. For this purpose, we add the function
<code><a href="../reference/order_integration.html">order_integration()</a></code> which performs a sequence of unit root
tests to determine the orders of each time series.</p>
<div class="section level3">
<h3 id="how-does-it-work">How does it work<a class="anchor" aria-label="anchor" href="#how-does-it-work"></a>
</h3>
<p>Starting from a maximum order (by default equal to 2), it differences
the data time until there can be at most one unit root. If the test is
not rejected for a particular series, we know this series if of order .
The series for which we do reject are integrated once (such that they
are differenced times from their original level), and the test is
repeated. By doing so until we have classified all series, we obtain a
full specification of the orders of all time series.</p>
</div>
<div class="section level3">
<h3 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h3>
<p>The function allows us to choose which unit root test we want to use.
Here we take <code>boot_fdr</code>. We don’t only get the orders out,
but also the appropriately differenced data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_orders</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/order_integration.html">order_integration</a></span><span class="op">(</span><span class="va">MacroTS</span><span class="op">[</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"boot_fdr"</span>, B <span class="op">=</span> <span class="fl">399</span>, </span>
<span>                                do_parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span>
<span><span class="co">#&gt; Progress: |------------------| </span></span>
<span><span class="co">#&gt;           ********************</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Orders</span></span>
<span><span class="va">out_orders</span><span class="op">$</span><span class="va">order_int</span></span>
<span><span class="co">#&gt; HICP_BE HICP_DE HICP_FR HICP_NL HICP_UK </span></span>
<span><span class="co">#&gt;       0       0       1       0       1</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Differenced data</span></span>
<span><span class="va">stationary_data</span> <span class="op">&lt;-</span> <span class="va">out_orders</span><span class="op">$</span><span class="va">diff_data</span></span></code></pre></div>
<p>To achieve the differencing, <code><a href="../reference/order_integration.html">order_integration()</a></code> uses
the function <code><a href="../reference/diff_mult.html">diff_mult()</a></code> which is also available as
stand-alone function in the package. Finally, a function is provided to
plot the found orders (not run):</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_order_integration.html">plot_order_integration</a></span><span class="op">(</span><span class="va">out_orders</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Cavaliere, G., Phillips, P.C.B., Smeekes, S., and Taylor, A.M.R.
(2015). Lag length selection for unit root tests in the presence of
nonstationary volatility. <em>Econometric Reviews</em>, 34(4),
512-536.</li>
<li>Elliott, G., Rothenberg, T.J., and Stock, J.H. (1996). Efficient
tests for an autoregressive unit root. <em>Econometrica</em>, 64(4),
813-836.</li>
<li>Friedrich, M., Smeekes, S. and Urbain, J.-P. (2020). Autoregressive
wild bootstrap inference for nonparametric trends. <em>Journal of
Econometrics</em>, 214(1), 81-109.</li>
<li>Moon, H.R. and Perron, B. (2012). Beyond panel unit root tests:
Using multiple testing to determine the non stationarity properties of
individual series in a panel. <em>Journal of Econometrics</em>, 169(1),
29-33.</li>
<li>Ng, S. and Perron, P. (2001). Lag Length Selection and the
Construction of Unit Root Tests with Good Size and Power.
<em>Econometrica</em>, 69(6), 1519-1554,</li>
<li>Palm, F.C., Smeekes, S. and Urbain, J.-P. (2008). Bootstrap unit
root tests: Comparison and extensions. <em>Journal of Time Series
Analysis</em>, 29(1), 371-401.</li>
<li>Palm, F. C., Smeekes, S., and Urbain, J.-.P. (2011). Cross-sectional
dependence robust block bootstrap panel unit root tests. <em>Journal of
Econometrics</em>, 163(1), 85-104.</li>
<li>Paparoditis, E. and Politis, D.N. (2003). Residual‐based block
bootstrap for unit root testing. <em>Econometrica</em>, 71(3),
813-855.</li>
<li>Perron, P. and Qu, Z. (2008). A simple modification to improve the
finite sample properties of Ng and Perron’s unit root tests.
<em>Economic Letters</em>, 94(1), 12-19.</li>
<li>Rho, Y. and Shao, X. (2019). Bootstrap-assisted unit root testing
with piecewise locally stationary errors. <em>Econometric Theory</em>,
35(1), 142-166.</li>
<li>Romano, J.P., Shaikh, A.M., and Wolf, M. (2008). Control of the
false discovery rate under dependence using the bootstrap and
subsampling. <em>Test</em>, 17(3), 417.</li>
<li>Romano, J. P. and Wolf, M. (2005). Stepwise multiple testing as
formalized data snooping. <em>Econometrica</em>, 73(4), 1237-1282.</li>
<li>Shao, X. (2010). The dependent wild bootstrap. <em>Journal of the
American Statistical Association</em>, 105(489), 218-235.</li>
<li>Shao, X. (2011). A bootstrap-assisted spectral test of white noise
under unknown dependence. <em>Journal of Econometrics</em>, 162,
213-224.</li>
<li>Smeekes (2013). Detrending bootstrap unit root tests.
<em>Econometric Reviews</em>, 32(8), 869-891.</li>
<li>Smeekes, S. (2015). Bootstrap sequential tests to determine the
order of integration of individual units in a time series panel.
<em>Journal of Time Series Analysis</em>, 36(3), 398-415.</li>
<li>Smeekes, S. and Taylor, A.M.R. (2012). Bootstrap union tests for
unit roots in the presence of nonstationary volatility. <em>Econometric
Theory</em>, 28(2), 422-456.</li>
<li>Smeekes, S. and Urbain, J.-P. (2014a). A multivariate invariance
principle for modified wild bootstrap methods with an application to
unit root testing. GSBE Research Memorandum No. RM/14/008, Maastricht
University.</li>
<li>Smeekes, S. and Urbain, J.-P. (2014b). On the applicability of the
sieve bootstrap in time series panels. <em>Oxford Bulletin of Economics
and Statistics</em>, 76(1), 139-151.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephan Smeekes, Ines Wilms.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
